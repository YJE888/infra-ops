# 내부 인프라 운영 및 기술 고도화

## 1. 프로젝트 개요

자사 SaaS 및 내부 인프라 운영 환경의 안정성 향상과 기술 고도화를 목표로 진행되었습니다.
운영 자동화, 무중단 인증서 관리, 폐쇄망 Kubernetes 구축, 모니터링 체계 수립 등을 통해 운영 효율 개선과 장애 예방 중심의 인프라 개선을 수행하였습니다.

- 수행 시기: 2025년 12월 ~
- 환경: AWS(EKS, EC2), On-Premise Kubernetes, 폐쇄망 환경
- 역할: 인프라 운영 및 자동화, Kubernetes 클러스터 구축·운영

---

## 2. 담당 역할

- 내부 인프라 운영 체계 개선 및 기술 고도화
- Kubernetes 기반 SaaS 운영 환경 관리(EKS)
- 인프라 자동화 및 표준화(Ansible)
- 인증서 관리 구조 개선 및 무중단 운영 환경 구축
- 폐쇄망 Kubernetes 클러스터 신규 구축
- 모니터링 체계 설계 및 알림 시스템 구축

---

## 3. 수행 내용

### 3.1 시스템 설정 자동화 전환

- 기존 Bash 스크립트 기반 서버 공통 사전 설정 프로세스를 Ansible 기반으로 전환
- 반복 작업을 Playbook으로 표준화하여 설치 과정 단순화
- 서버 구축 시간 단축 및 운영 작업 일관성 확보

---

### 3.2 Harbor 이미지 레지스트리 인증서 갱신 안정화

- EC2 환경에서 운영 중인 Harbor(자사 이미지 레지스트리) 인증서 갱신 시 서비스 중단 문제를 분석
- 기존 HTTP-01 방식 인증서 갱신 과정에서 매월 Harbor Nginx 재시작이 발생하여 레지스트리 서비스가 일시 중단되는 이슈 확인
- Route53을 활용한 DNS-01 방식으로 인증서 갱신 구조를 변경하고, Certbot Hook 스크립트를 적용하여 불필요한 Nginx 재시작을 제거하고 인증서 갱신 시점에만 Nginx 설정을 재적용하도록 개선
- 인증서 자동 갱신 과정에서도 레지스트리 무중단 운영 환경을 구축하여 안정성 향상

---

### 3.3 자산 인프라 모니터링 환경 구축

- 기존에 모니터링 체계가 부재하여 서버 헬스체크가 불가능한 환경 개선
- ICMP 및 HTTPS 기반 Prometheus 모니터링 구성을 통해 자산 서버 및 서비스 가용성 상태 수집
- Grafana 대시보드 구성을 통해 서버 및 서비스 상태 시각화
- Alertmanager 설정 및 Slack 연동으로 장애 발생 시 실시간 알림 체계 구축
- 이를 통해 장애 인지 속도 향상 및 선제적 대응 가능 환경 마련

---

### 3.4 Kubernetes 인증서 갱신 자동화 구축

- 다수의 자산 Kubernetes 클러스터(총 15대) 대상 Ansible 기반 인증서 갱신 자동화 구축
- 인증서 만료 임박 시에만 마스터 노드를 순차적으로 갱신하도록 로직 구성
- 월 1회 Cron 기반으로 Playbook 자동 실행하여 인증서 만료로 인한 장애 리스크 제거
- 수동 갱신 작업 제거를 통해 운영 안정성 및 관리 효율성 향상
- 기존 특정 서버에 의존하던 실행 환경을 탈피하기 위해
  NAS(Container Manager)의 컨테이너 환경에서 실행 가능한 Ansible, Cron 전용 커스텀 컨테이너 이미지 제작

---

### 3.5 SaaS 운영 환경 및 AMI 업그레이드

- SaaS 운영 환경(EKS) 전반 점검 및 업그레이드 수행
- EC2 기반 AMI 업그레이드를 통해 보안 패치 및 OS 최신화

---

### 3.6 폐쇄망 환경 Kubernetes 클러스터 구축

- 폐쇄망 환경에서의 Kubespray 기반 Kubernetes 클러스터 구축 문서화
- 컨테이너 이미지 및 필수 바이너리 사전 수집 후 내부 배포 구조 설계
- Kubespray Inventory 및 설정을 환경 제약에 맞게 커스터마이징
- 마스터·워커 노드 구성 및 클러스터 정상 동작 검증

## 4. 작업 시 고려사항

- 운영 중 서비스 중단 최소화를 최우선으로 고려
- 자동화된 운영 절차의 재현성을 확보하기 위한 구성 및 실행 절차 문서화

---

## 5. 결과

- 내부 인프라 운영 작업의 자동화 및 표준화 달성
- Harbor 인증서 갱신 및 업그레이드 작업 시 서비스 중단 이슈 제거
- 폐쇄망 환경에서도 안정적인 Kubernetes 클러스터 구축 경험 확보
- 모니터링 및 알림 체계 구축을 통해 운영 안정성과 대응 속도 향상

---

## 6. 사용 기술

- InfraAWS
  - Cloud : AWS
  - On-Premise
- Container(Orchestration) : Kubernetes(Kubespray)
- Automation : Ansible, Shell Script, Cron
- Monitoring : Prometheus, Grafana, Alertmanager
- Image / Registry : Harbor
- Container Runtime : Docker
